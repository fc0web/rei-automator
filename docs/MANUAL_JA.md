# Rei Automator v0.4.0 取扱説明書

## 目次

1. [はじめに](#はじめに)
2. [インストール](#インストール)
3. [画面構成](#画面構成)
4. [基本操作](#基本操作)
5. [Reiコマンド一覧](#reiコマンド一覧)
6. [画像認識・OCR](#画像認識ocr)
7. [日本語からコード生成](#日本語からコード生成)
8. [スケジュール実行](#スケジュール実行)
9. [エラーハンドリング](#エラーハンドリング)
10. [デバッグ機能](#デバッグ機能)
11. [スクリプト管理](#スクリプト管理)
12. [設定](#設定)
13. [トラブルシューティング](#トラブルシューティング)
14. [ライセンス](#ライセンス)

---

## はじめに

Rei Automatorは、Rei言語の思想に基づいたWindows向けPC自動化ツールです。マウス操作、キーボード入力、画像認識、OCRなどを、シンプルなReiコードで記述して自動実行できます。

UWSCの精神を受け継ぎ、「日本語で指示 → 読めるReiコード → 確認して実行」という三層構造で、透明性のある安全な自動化を実現します。

### 動作環境

- OS: Windows 10 / Windows 11（64bit）
- メモリ: 4GB以上推奨
- ディスク: 約200MB

---

## インストール

### Portable版（推奨）

1. [GitHub Releases](https://github.com/fc0web/rei-automator/releases/tag/v0.4.0) から `ReiAutomator-0.4.0-portable.exe` をダウンロード
2. 任意のフォルダに配置
3. ダブルクリックで起動

インストール不要で、USBメモリに入れて持ち運ぶこともできます。

### インストーラー版

1. [GitHub Releases](https://github.com/fc0web/rei-automator/releases/tag/v0.4.0) から `Rei Automator Setup 0.4.0.exe` をダウンロード
2. インストーラーを実行
3. インストール先を選択して「インストール」をクリック
4. デスクトップショートカットまたはスタートメニューから起動

### 初回起動時の注意

コード署名がないため、Windows SmartScreenの警告が表示される場合があります。「詳細情報」→「実行」をクリックしてください。これは個人開発のソフトウェアでは一般的なことで、安全にお使いいただけます。

---

## 画面構成

Rei Automatorの画面は以下の要素で構成されています。

### ツールバー

画面上部のボタン群です。

- 📷 **キャプチャ** — 画面をキャプチャして画像認識用のテンプレートを作成
- 🎯 **座標指定** — 画面上でクリックして座標を取得
- 📂 **開く** — .reiスクリプトファイルを読み込み
- 💾 **保存** — 現在のコードを.reiファイルに保存
- 📥 **インポート** — スクリプトをインポート
- 📤 **エクスポート** — スクリプトをエクスポート

### 日本語入力パネル

日本語で操作内容を入力し、「コード生成」ボタンを押すと、対応するReiコードが自動生成されます。

### コードエディタ

Reiコードを直接記述・編集するエリアです。生成されたコードの確認・修正もここで行います。

### サイドバー

左側のサイドバーでスクリプトの一覧を管理できます。複数のスクリプトを切り替えて作業できます。

### 下部タブパネル

- **ログ** — 実行時のログメッセージを表示
- **変数一覧** — 現在の変数とその値を表示
- **エラー一覧** — パースエラーや実行エラーを表示
- **実行履歴** — 過去の実行記録を表示

### 実行コントロール

- ▶ **実行** — スクリプトを実行
- ⏹ **停止** — 実行を中止
- ⏸ **一時停止** — 実行を一時停止（再度押すと再開）
- **ESCキー** — どの画面からでも緊急停止

---

## 基本操作

### スクリプトを書いて実行する

1. コードエディタにReiコードを入力します
2. ▶ **実行** ボタンをクリックします
3. スクリプトが上から順に実行されます
4. 実行中はログタブで進行状況を確認できます
5. 停止したい場合は ⏹ **停止** または **ESCキー** を押します

### 簡単な例

```
// メモ帳のウィンドウをクリックして文字を入力
click(500, 400)
wait(1s)
type("Hello from Rei Automator!")
```

### スクリプトの保存と読み込み

- 💾 **保存** をクリック → ファイル名を指定して .rei ファイルに保存
- 📂 **開く** をクリック → 保存した .rei ファイルを読み込み

---

## Reiコマンド一覧

### マウス操作

| コマンド | 説明 | 例 |
|---------|------|-----|
| `click(x, y)` | 指定座標を左クリック | `click(500, 400)` |
| `dblclick(x, y)` | 指定座標をダブルクリック | `dblclick(100, 200)` |
| `rightclick(x, y)` | 指定座標を右クリック | `rightclick(300, 150)` |
| `move(x, y)` | マウスカーソルを移動 | `move(600, 300)` |
| `drag(x1, y1, x2, y2)` | ドラッグ操作 | `drag(100, 100, 500, 500)` |

### キーボード操作

| コマンド | 説明 | 例 |
|---------|------|-----|
| `type("文字列")` | テキストを入力 | `type("こんにちは")` |
| `key("キー名")` | 特殊キーを押す | `key("Enter")` |
| `shortcut("修飾+キー")` | ショートカットキー | `shortcut("Ctrl+S")` |

#### 使用可能な特殊キー

Enter, Tab, Escape, Backspace, Delete, Space, Up, Down, Left, Right, Home, End, PageUp, PageDown, F1〜F12

#### ショートカットキーの例

```
shortcut("Ctrl+C")      // コピー
shortcut("Ctrl+V")      // 貼り付け
shortcut("Ctrl+Z")      // 元に戻す
shortcut("Ctrl+S")      // 保存
shortcut("Alt+F4")       // ウィンドウを閉じる
shortcut("Ctrl+Shift+N") // 複数修飾キー
```

### 待機

| コマンド | 説明 | 例 |
|---------|------|-----|
| `wait(Ns)` | N秒待機 | `wait(3s)` |
| `wait(Nms)` | Nミリ秒待機 | `wait(500ms)` |
| `wait(Nm)` | N分待機 | `wait(1m)` |

### ループ

```
// 5回繰り返す
loop(5):
  click(100, 200)
  wait(1s)

// 無限ループ（ESCで停止）
loop:
  click(300, 400)
  wait(2s)
```

ループ内のコマンドは**インデント（スペース2つ）**で示します。

### 変数

```
// 変数を設定
set count = 5
set message = "Hello"

// パラメータとして宣言（スクリプト先頭で使用）
param targetX = 500
param targetY = 400

// 変数を使用
click(targetX, targetY)
type(message)
```

### コメント

```
// これはコメントです（実行されません）
click(500, 400)  // 行末コメント
```

---

## 画像認識・OCR

### テンプレートマッチング（画像認識）

画面上の画像を検索して、一致する場所を自動的に見つけます。座標を直接指定する必要がないため、ウィンドウの位置が変わっても動作します。

#### テンプレート画像の準備

1. 📷 **キャプチャ** ボタンをクリック
2. 認識させたい部分（ボタン、アイコンなど）を選択
3. テンプレート名を付けて保存

#### 画像認識コマンド

| コマンド | 説明 | 例 |
|---------|------|-----|
| `find("テンプレート名")` | 画面上でテンプレートを検索 | `find("login-button")` |
| `click(found)` | 最後にfindで見つかった場所をクリック | `click(found)` |
| `find_click("テンプレート名")` | 検索とクリックを一度に実行 | `find_click("ok-button")` |
| `wait_find("テンプレート名", タイムアウト)` | 見つかるまで待機 | `wait_find("signal", 30000)` |

#### 実用例：画面のボタンが表示されたらクリック

```
// "確認ボタン"のテンプレートが見つかるまで最大30秒待機
wait_find("confirm-button", 30000)
// 見つかったらクリック
click(found)
wait(1s)
```

#### 実用例：MT4のシグナル監視

```
// 無限ループで画面を監視
loop:
  find("buy-signal")
  click(found)
  wait(5s)
```

### OCR（文字認識）

Tesseract.jsを使用して、画面上のテキストを読み取ることができます。数値の監視や、テキストの表示確認などに活用できます。

---

## 日本語からコード生成

日本語入力パネルに操作内容を日本語で入力すると、対応するReiコードを自動生成します。

### 入力例と生成結果

| 日本語入力 | 生成されるReiコード |
|-----------|-------------------|
| 座標(500,400)をクリック | `click(500, 400)` |
| 3秒待つ | `wait(3s)` |
| "こんにちは"と入力 | `type("こんにちは")` |
| Enterキーを押す | `key("Enter")` |
| Ctrl+Sを押す | `shortcut("Ctrl+S")` |
| 5回繰り返す | `loop(5):` |

生成されたコードはコードエディタに挿入されます。内容を確認・修正してから実行してください。

---

## スケジュール実行

スクリプトを指定した時間や間隔で自動実行できます。

### スケジュールの種類

| 種類 | 説明 | 例 |
|------|------|-----|
| **once** | 一回のみ実行 | 「今日の15:00に実行」 |
| **interval** | 指定間隔で繰り返し | 「5分ごとに実行」 |
| **daily** | 毎日指定時刻に実行 | 「毎日9:00に実行」 |
| **weekly** | 毎週指定曜日・時刻に実行 | 「毎週月曜9:00に実行」 |

### スケジュールの設定方法

1. UIからスケジュールパネルを開く
2. 実行するスクリプトを選択
3. スケジュールの種類と時間を設定
4. 「作成」をクリック

スケジュールはアプリ起動中のみ有効です。設定はアプリを閉じても保存されます。

---

## エラーハンドリング

スクリプト実行中にエラーが発生した場合の動作を3つのポリシーから選択できます。

| ポリシー | 動作 |
|---------|------|
| **stop**（停止） | エラーが発生した時点でスクリプトを停止します |
| **skip**（スキップ） | エラーが発生したコマンドをスキップして次に進みます |
| **retry**（リトライ） | エラーが発生したコマンドを再試行します |

UIのドロップダウンメニューからポリシーを選択してから実行してください。

---

## デバッグ機能

### ステップ実行

1. 「ステップ実行」チェックボックスをONにする
2. ▶ **実行** をクリック
3. 1行ずつ実行が停止します
4. 「次へ」ボタンで次のコマンドに進みます
5. 「継続」ボタンで通常実行に切り替えます

### 変数パネル

`set` や `param` で定義した変数の現在の値をリアルタイムで確認できます。

### エラー一覧

コードにパースエラーがある場合、エラー一覧タブに行番号とエラーメッセージが表示されます。

---

## スクリプト管理

### サイドバー

左側のサイドバーで複数のスクリプトを管理できます。

- **新規作成** — 空のスクリプトを作成
- **スクリプト切り替え** — クリックで別のスクリプトに切り替え
- **削除** — 不要なスクリプトを削除

### インポート/エクスポート

- 📥 **インポート** — 外部の .rei ファイルをスクリプト一覧に追加
- 📤 **エクスポート** — スクリプトを .rei ファイルとして出力

---

## 設定

### 言語設定

9言語から選択できます。メニューから言語を切り替えると、UI全体が即座に翻訳されます。設定はアプリ再起動後も保持されます。

対応言語: 日本語、English、中文（简体）、한국어、Deutsch、Español、Français、Português、Русский

### 設定ファイルの場所

```
C:\Users\<ユーザー名>\AppData\Roaming\rei-automator\settings.json
```

---

## トラブルシューティング

### アプリが起動しない

- Windows 10 / 11（64bit）であることを確認してください
- SmartScreenの警告が出た場合は「詳細情報」→「実行」をクリックしてください
- ウイルス対策ソフトがブロックしている場合は、例外に追加してください

### クリックが正しい位置に行かない

- ディスプレイのスケーリングが100%以外の場合、座標がずれることがあります
- Windows設定 → ディスプレイ → 拡大縮小とレイアウト を確認してください
- 画像認識（find / find_click）の使用を検討してください。座標ずれの問題を回避できます

### 画像認識が見つからない

- テンプレート画像が画面上の表示と一致しているか確認してください
- 解像度やテーマの変更で画面の見た目が変わると、認識できなくなる場合があります
- テンプレートを再作成してみてください

### ESCで停止しない

- 他のアプリケーションがESCキーを占有している可能性があります
- タスクマネージャー（Ctrl+Shift+Esc）からRei Automatorを終了してください

### 日本語入力ができない

- `type()` コマンドは日本語テキストに対応しています
- IMEが有効になっていることを確認してください

---

## ライセンス

Rei Automatorはデュアルライセンスです。

- ✅ **個人利用** — 無料
- ✅ **非営利団体** — 無料
- ✅ **教育・研究目的** — 無料
- 💼 **商用利用** — ライセンスが必要です

商用ライセンスについては以下にお問い合わせください。

- GitHub Issues: https://github.com/fc0web/rei-automator/issues
- note: https://note.com/nifty_godwit2635
- Email: fc2webb@gmail.com

---

## リンク

- ダウンロード: https://github.com/fc0web/rei-automator/releases/tag/v0.4.0
- ソースコード: https://github.com/fc0web/rei-automator
- Rei言語: https://github.com/fc0web/rei-lang

---

*Powered by Rei Language — 中心-周囲パターンで世界を記述する*

*Copyright 2024-2026 Nobuki Fujimoto*
