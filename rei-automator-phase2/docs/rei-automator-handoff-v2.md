# Rei PC自動操作ツール — チャット引継ぎドキュメント v2

**更新日:** 2026年2月18日
**前回チャット:** https://claude.ai/chat/f34dd837-e0df-4a86-97a3-182ead10e869
**目的:** 次回チャットで開発・検討を継続するための全情報引継ぎ

---

## 1. プロジェクト概要

Rei言語（fc0web/rei-lang）の事業化として、PC自動操作ツールを開発する。
UWSC（開発者逝去により消滅した日本の定番PC自動化ツール）の後継を狙い、
大手AI企業が構造的に参入できないニッチ市場を取る。

**ツール名は未決定。** Rei本体とは別名にすべきという結論。
理由：ターゲット層が違う（Rei=開発者・研究者、本ツール=一般ユーザー）、
ブランド印象の干渉回避、失敗時のリスク分離。「Powered by Rei」表記で十分。

---

## 2. 戦略的背景（なぜこの市場か）

### 2.1 大手AI企業の現状

- **Microsoft Copilot Studio Computer Use:** 月額$30+ 従量課金、米国のみプレビュー、企業向け、Azure必須
- **OpenAI Operator:** 2025年8月31日サービス終了済み、成功率38-58%、ブラウザ内のみ
- **Claude Computer Use:** API経由、開発者向け、$20/月〜
- **Google:** 消費者向けPC自動化製品なし

### 2.2 大手が構造的に入れない理由

大手は「やりたいけど怖くてできない」状態：

1. 責任問題（AI操作→事故→訴訟リスク）
2. セキュリティ（AIエージェント乗っ取り）
3. 収益矛盾（完全自動化は自社UI・広告収益を毀損）
4. 規制未整備
5. 信頼性不足（成功率38〜58%）
6. コスト構造（毎回GPU消費→安価提供不可）

**Reiの構造的回避策:**
```
大手: 「AIがあなたのPCを操作します」→ 企業責任 → 制限だらけ
Rei:  「あなたがコードを確認して実行する」→ 自己責任 → 制限なし（道具）
```

---

## 3. 競合分析（前回チャットで詳細調査済み）

### 3.1 PC自動操作ツール世界地図

**Tier 1: コード必須・無料**
| ツール | 画像認識 | OCR | GUI | 特記事項 |
|--------|----------|-----|-----|----------|
| AutoHotkey | △ 原始的 | ✗ | ✗ CUI | 英語圏最大。完全無料・GPLv2。v1→v2移行で混乱中 |
| AutoIt | △ 基本的 | ✗ | △ 簡易 | BASIC風構文、Windows専用 |
| PyAutoGUI | △ 基本的 | ✗ | ✗ コード | Python必須 |

**Tier 2: 視覚認識あり・無料だが複雑**
| ツール | 画像認識 | OCR | GUI | 特記事項 |
|--------|----------|-----|-----|----------|
| SikuliX | ◎ | ◯ | △ IDE | 最も近い競合。Java必須。開発実質停滞（個人メンテ） |

**Tier 3: 有料・企業向け** — UiPath、Automation Anywhere等
**Tier 4: ブラウザ限定** — Axiom.ai、Automa等

### 3.2 AutoHotkeyの弱点（rei-automatorの差別化ポイント）

1. **画像認識が弱い** — ImageSearchは原始的、完全一致に近い
2. **OCRが存在しない** — 画面上の文字を読み取れない
3. **v1/v2の移行混乱** — コミュニティ分裂、情報が混在
4. **構文が古い** — 2000年代設計
5. **Windows 11との相性問題** — 文字送信欠落等の報告あり
6. **GUIが貧弱** — まともなUIを作ることが苦行
7. **日本語対応が弱い** — IME周りの問題

### 3.3 rei-automator vs 全競合

```
                    AutoHotkey  SikuliX    PyAutoGUI  rei-automator
画像認識             △          ◎          △          ◎
OCR                 ✗          ◯          ✗          ◎（tesseract.js内蔵）
自然言語入力         ✗          ✗          ✗          ◎（唯一）
GUI統合              ✗          △          ✗          ◎
日本語対応           ✗          ✗          ✗          ◎
インストール容易     ◯          ✗(Java必須) △(Python必須)  ◎(EXE一発)
開発継続性           ◯          ✗(停滞)    ◯          ◯
```

**世界のどこにも「画像認識 + OCR + 自然言語入力 + GUI統合」を全部持った無料の軽量PC自動化ツールは存在しない。**

### 3.4 「ChatGPT + AutoHotkey」の脅威と差別化

ChatGPT等にAutoHotkeyコードを書いてもらえば「コードが書けない人」もAutoHotkeyを使える。
しかしrei-automatorはUXの統合で差別化できる：

- ChatGPT+AHKの場合: AHKインストール→ChatGPT→コードコピー→ファイル保存→画像手動切り出し→座標手動調査→実行→エラー時ChatGPTに戻る（10ステップ）
- rei-automatorの場合: 起動→キャプチャ→座標指定→日本語入力→実行（4ステップ）

**最大の差別化は「視覚認識の統合」。** tesseract.jsやopencvのインストール・設定・AHKとの連携は、AIにコードを書いてもらっても初心者には無理。

---

## 4. 市場の実態（前回チャットで確認済み）

### 4.1 UWSCの実需要

UWSCが「絶対に必要」だった理由: **アプリ横断操作**
- MT4のサインを見て → 別のサイト（旧ハイローオーストラリア等のバイナリーオプション）でクリック
- MT4のサインを見て → TradingViewで操作
- 競艇・競馬・競輪サイトでの自動投票

**共通パターン：「アプリAの状態を見て、アプリBを操作する」**
→ MT4内部のEAでは不可能。UWSCでしかできなかった。

### 4.2 現在のユーザー状況

- **UWSC層:** Windows 11でもまだUWSCを使っている。ただしコードが書ける人限定
- **ギャンブル系:** 高額な専用自動売買ソフトを購入（お金を払う意思がある市場）
- **TradingView:** PineScript必要（コード知識必須）
- **全てに共通:** 「コードが書けない人は排除されている」

### 4.3 表と裏の戦略

- **表（公式マーケティング）:** データ転記、ファイル操作、繰り返し入力、レポート自動化
- **裏（言わないが実需要）:** FXサイン監視→別サイトクリック、競艇等の自動投票
- 表に出さない理由: 金融取引の推奨と受け取られるリスク回避

### 4.4 UWSCの画像認識の弱点（ユーザー実体験）

UWSCのCHKIMGは**少しでもPC画面の色が変わると使えなくなる**問題があった。
原因: ピクセル単位の完全一致に近いマッチング。

rei-automatorの解決策（多層認識）:
```
レベル1: 色検出（UWSCと同等）→ 最軽量だが色変化で壊れる
レベル2: 画像マッチング（opencv、類似度閾値付き）→ 多少の色変化に耐える
レベル3: OCR文字認識（tesseract.js）→ 色変化に完全耐性
レベル4: AI視覚認識（有料・API）→ 最も柔軟だがコスト・遅延あり
```

組み合わせ例:
```rei
// まず文字で探す（色変化に強い）、見つからなければ画像で探す
screen.find(text: "約定") or screen.find(captured_1, 0.80)
  -> click(target_1)
```

---

## 5. 技術設計

### 5.1 三層アーキテクチャ

```
第1層: 自然言語入力（日本語/英語）
  ↓
第2層: Reiコード生成
  ├── ローカルパターンマッチ（基本操作：API不要・無料）
  └── 外部AI API（複雑な指示のみ：Claude/GPT経由）
  ↓
  【ユーザー確認】← 大手との構造的違い（コード2〜5行で確認一瞬）
  ↓
第3層: 実行エンジン
  ├── マウス操作
  ├── キーボード操作
  ├── 画面認識（色検出・画像マッチング・OCR）
  └── ウィンドウ操作
```

### 5.2 UWSCの12ステップ → Reiの3ステップ

**UWSC:** PrintScreen→ペイント貼付→切取り→RGB確認→画像保存→座標確認→コード手書き→起動→実行...（12ステップ）
**Rei:** ①キャプチャ範囲選択 → ②座標指定クリック → ③日本語入力→実行（3ステップ）

### 5.3 システム構成

```
rei-automator/
├── lib/
│   ├── core/              ← Reiエンジン（既存流用）
│   ├── auto/              ← PC操作層（新規・約2,000行）
│   │   ├── screen.ts          画面キャプチャ・色取得
│   │   ├── image-match.ts     画像マッチング（opencv4nodejs）
│   │   ├── ocr.ts             文字認識（tesseract.js）
│   │   ├── mouse.ts           マウス操作
│   │   ├── keyboard.ts        キーボード操作
│   │   └── window.ts          ウィンドウ操作
│   ├── nlp/               ← 日本語→Reiコード変換（約500行）
│   │   ├── local-patterns.ts  ローカルパターン変換（正規表現・オフライン）
│   │   └── ai-convert.ts      AI API連携
│   └── ui/                ← UI層（約1,000行）
│       ├── main-window.ts     メインUI
│       ├── capture-mode.ts    キャプチャモード
│       └── target-mode.ts     座標指定モード
├── captures/                  キャプチャ画像自動保存
├── scripts/                   ユーザーのReiスクリプト
└── package.json
```

### 5.4 技術スタック

| レイヤー | 技術 |
|----------|------|
| UI | Electron |
| Reiランタイム | 既存Reiエンジン流用 |
| マウス/KB | robotjs or nutjs（Windows実テストで決定） |
| 画面キャプチャ | screenshot-desktop |
| 画像マッチング | opencv4nodejs（類似度閾値付き） |
| OCR | tesseract.js（日本語・英語・100+言語対応・オフライン） |
| Win32 API | node-ffi-napi |
| AI連携 | fetch API（Claude/GPT） |

### 5.5 コード量見積もり: 合計約4,200行

### 5.6 画面認識の4段階設計（重要な差別化ポイント）

```
完全オフライン・無料で可能：
  ✓ 色検出（ピクセルRGB取得）
  ✓ 画像マッチング（opencv4nodejs、類似度閾値付き）
  ✓ 文字・数字認識（tesseract.js内蔵）

AI API利用・有料で可能：
  ✓ 高精度な図・グラフの理解
  ✓ 複雑なレイアウトの表の解析
  ✓ screen.ask("チャートは上昇トレンドですか？")
```

### 5.7 Reiコード構文（設計済み）

```rei
// 色認識→クリック
screen(100, 200).color == "#FF0000" -> click

// 画像検索（類似度指定）
screen.find(captured_1, 0.85) -> dblclick

// 文字認識
screen(300, 400).text == "約定完了" -> click(target_1)

// 数字認識して条件判定
screen(200, 150).text.number >= 500 -> click(target_買い)

// 条件待機→連続操作→無限ループ
loop:
  watch(captured_1)
    -> wait(3s) -> click(target_1)
    -> wait(2s) -> click(target_2)

// ウィンドウ操作
window("MetaTrader") -> activate -> resize(800, 600)

// AI図認識（有料機能・Phase 3以降）
screen.ask("チャートは上昇トレンドですか？") == "はい" -> click(target_1)
```

### 5.8 日本語→Reiコード ローカル変換パターン

| 日本語 | Reiコード |
|--------|-----------|
| 「〇〇をクリック」 | `click(target_〇〇)` |
| 「〇〇と入力」 | `type("〇〇")` |
| 「〇〇秒待つ」 | `wait(〇〇s)` |
| 「ずっと繰り返す」 | `loop:` |
| 「〇〇が出たら」 | `watch(captured_〇〇) ->` |

### 5.9 UWSC→Rei 構文対応表

| UWSC | Rei |
|------|-----|
| `BTN(LEFT, CLICK, x, y)` | `click(x, y)` |
| `CHKIMG("path.bmp")` | `screen.find(captured_1)` |
| `PEEKCOLOR(x, y)` | `screen(x, y).color` |
| `SLEEP(sec)` | `wait(秒s)` |
| `WHILE TRUE〜WEND` | `loop:` |
| `IFB〜ENDIF` | `条件 -> 操作` |
| `GETID("title")` | `window("title")` |

### 5.10 動作環境

- Windows 10/11（64bit）のみ。Mac/Linux/スマホは不可
- メモリ4GB以上、ディスク約200MB
- ネットワーク: 基本不要（AI変換時のみ）

### 5.11 スマホ対応について（前回確認済み）

- スマホ直接操作: **不可能**（iOS/Androidともにアプリ間操作をOSレベルで禁止）
- Androidエミュ（BlueStacks等）経由: **既存設計で対応可能**
- iOS: エミュも存在しない（完全不可）
- HarmonyOS NEXTスマホ: 不可。HuaweiのPC（Windows搭載）なら動く

---

## 6. ビジネスモデル（前回チャットで大幅に修正）

### 6.1 基本方針: 基本無料は必須

UWSCが広まった最大の理由は無料だったこと。「スクリプト3個まで」のような制限付き無料は悪印象を生む。

### 6.2 価格設計（修正版）

**無料版（¥0）:**
- ✓ 全PC操作機能（マウス・キーボード・画面認識・ウィンドウ操作）
- ✓ Reiコード手書き・実行（無制限）
- ✓ キャプチャモード・座標指定モード
- ✓ スクリプト保存・読込（無制限）
- ✓ 日本語ローカル変換（基本パターン・オフライン）
- ✓ 画像マッチング（opencv、類似度閾値付き）
- ✓ 文字・数字認識（tesseract.js）
- → **UWSCと同等以上の体験が完全無料**

**有料版（¥980/月 or ¥5,800買い切り）:**
- ✓ AI日本語変換（複雑な指示をReiコードに変換）
- ✓ スケジューラー（時間指定・定期実行）
- ✓ UWSC→Rei自動変換（移行支援）

**プロ版:** 初期段階では不要。ユーザーの反応を見てから追加。

### 6.3 有料化の根拠

- **AI日本語変換:** 実コストがかかる（API呼び出し¥1〜5/回）。なくても完全に使える。一度体験すると手放せなくなる
- **スケジューラー:** 業務利用で必須。個人のFXサイン監視でも需要あり
- **UWSC変換:** UWSCスクリプト持っている人にとって高価値。AI APIで変換するので同じコスト構造

### 6.4 却下された有料機能

- **複数スクリプト同時実行:** マウスカーソルは1つしかないため物理的に不可能（監視だけなら可能だが、操作は1つずつ順番）

### 6.5 損益分岐: 約50ユーザー（ベーシック×50≒¥49,000/月）

### 6.6 参考ビジネスモデル

- **Duolingo型フリーミアム**が最も参考になる（無料で大量ユーザー集め→一部を有料転換）
- Khan Academy型（寄付型）は個人開発者には不可能（ビルゲイツ級パトロン必要）
- VS Code型（完全無料）はMicrosoftのエコシステム戦略。個人では持続不可

---

## 7. UI仕様

```
┌──────────────────────────────────────────────────┐
│  [ツール名] v0.1                           [_][×]│
├──────────────────────────────────────────────────┤
│ [📷キャプチャ] [🎯座標指定] [📂開く] [💾保存]      │
├──────────────────────────────────────────────────┤
│ 日本語入力:                                       │
│ ┌──────────────────────────────────────────────┐ │
│ │（ここに日本語で操作内容を入力）               │ │
│ └──────────────────────────────────────────────┘ │
│                              [🔄 コード生成]      │
├──────────────────────────────────────────────────┤
│ Reiコード:                                        │
│ ┌──────────────────────────────────────────────┐ │
│ │ loop:                                        │ │
│ │   watch(captured_1)                          │ │
│ │     -> wait(3s) -> click(target_1)           │ │
│ └──────────────────────────────────────────────┘ │
├──────────────────────────────────────────────────┤
│ キャプチャ済み素材:                                │
│ [captured_1: 🖼赤サイン] [target_1: 🎯(450,320)]  │
├──────────────────────────────────────────────────┤
│   [▶ 実行]  [⏹ 停止]  [⏸ 一時停止]               │
│   ステータス: 待機中                               │
└──────────────────────────────────────────────────┘
```

---

## 8. 開発ロードマップ

### Phase 1: MVP — 1〜2ヶ月（チャット5〜8回）
- マウス/キーボード操作
- 色検出
- 待機・ループ
- Reiコード直接記述・実行
- 基本UI

### Phase 2: UX強化 — 2〜4週間（チャット5〜8回）
- キャプチャモード
- 座標指定モード
- 画像マッチング（opencv、類似度閾値付き）
- 文字・数字認識（tesseract.js）
- 日本語ローカル変換
- スクリプト保存・読込

### Phase 3: AI連携 — 1〜2週間（チャット3〜5回）
- AI API連携（複雑な日本語変換）
- AI視覚認識（screen.ask）
- ウィンドウ操作
- スケジューラー
- UWSC→Rei自動変換
- エラーハンドリング

### Phase 4: 将来
- 英語対応
- 多言語展開
- プラグインシステム

---

## 9. 市場調査まとめ（前回チャットで実施）

### 9.1 ビジネスツール市場

- Tier 1（兆円規模）: Microsoft 365、Google Workspace、Salesforce
- Tier 2（数千億円）: SAP/Oracle ERP、Slack/Teams、Zoom
- Tier 3（特定業務）: QuickBooks、Jira、HubSpot、Figma等
- Tier 4（新興）: Notion、ChatGPT/Claude、**Zapier**、Airtable

**Zapierとの接点:** Zapierは「アプリAで何か起きたら、アプリBで何かする」を自動化。rei-automatorと発想は似るが、Zapierはクラウド・API経由で対応アプリ限定。rei-automatorは画面操作で「APIを持たないアプリ」を繋げられる独自ポジション。

### 9.2 教育・学習ツール市場

- Tier 1（億人規模）: YouTube、Khan Academy（1.8億人・完全無料・寄付型）、Duolingo（5000万DAU・フリーミアム）、Google Classroom
- Tier 2（数千万人）: Coursera（1.1億人）、Udemy（5900万人）、edX、LinkedIn Learning、Quizlet
- Tier 3（企業研修）: Moodle、Canvas、Docebo等

**日本と世界の違い:**
| | アメリカ | 日本 |
|---|---|---|
| K-12学習 | Khan Academy（無料） | スタディサプリ、すらら、進研ゼミ |
| 語学学習 | Duolingo（無料） | Duolingo + 英会話スクール |
| 文化 | 無料・オープンが主流 | 有料・囲い込みが主流 |

日本では「教育は有料」文化が強い → 有料でも売れる余地がある。

### 9.3 収益モデル比較

**Khan Academy:** 非営利・寄付型。収入約1.2億ドル。75%が富裕層・財団の寄付（ゲイツ財団、イーロン・マスク等）。個人が真似不可。

**Duolingo:** 営利・フリーミアム。収入約7.5億ドル。81%がサブスク（Super $7-13/月、Max $14-30/月）。無料版に意図的な不便さ（ハート消費）→有料誘導。有料課金者950万人（前年比44%増）。

---

## 10. VPS環境について（前回確認済み）

- FXトレーダーはVPS上でMT4+EAを24時間稼働させている
- VPS上ではマウスカーソルが表示されず、UWSCは使えない
- Win32 APIのSendMessage/PostMessageで回避の可能性はあるが、確実ではない
- **Phase 1では対応しない。** まずは「目の前のPCで動くもの」が最優先
- MT4内部で完結する取引にはEAが最適解。rei-automatorが狙うのは「アプリ横断操作」

---

## 11. Excel/Word等のWindowsアプリ操作（前回確認済み）

- **方法1: 画面操作（標準アプローチ）** — マウスクリック+キーボードで操作。UWSCと同じ方式。どんなアプリでも動く
- **方法2: COM連携（高度）** — 画面を占有せず内部操作。開発コスト大。Microsoftアプリ固有
- **結論:** Phase 1〜3では方法1で十分。rei-automatorの本領は「アプリ横断操作」（例: Excel→社内システム転記）

---

## 12. 開発上の制約事項

**Claudeの環境はLinux（Ubuntu）のため、以下ができない:**
- robotjs/nutjsのWindows動作テスト
- Electronウィンドウの表示確認
- 画面キャプチャの実テスト
- マウス操作の実テスト

**開発フロー:**
Claude側でコード生成 → NobukiさんのWindows PCで動作確認 → 修正依頼 → 繰り返し

---

## 13. 未決定事項

1. **ツール名**: Rei本体とは別名にする方針。具体名は未決定
2. **Phase 1の最初の一歩**: プロジェクト雛形＋Electron基盤＋基本UIから着手予定
3. **robotjs vs nutjs**: 実際にWindows環境で試して決定
4. **教育事業との優先順位**: PC自動化を先行する方向だが最終確定はしていない
5. **認識の優先度と類似度閾値の具体設計**: 仕様書への追加が必要

---

## 14. 前回チャットで議論したが結論に至っていない事項

- **「世界言語全対応で革命レベル」の可能性:** 技術的にはAI APIで多言語対応可能だが、ローカル変換パターンの全言語対応は膨大な作業。まず日本市場を取りきることが先
- **教育ツール事業の方向性:** 議論したが具体的な結論には至っていない
- **Duolingo型ゲーミフィケーションの導入:** 参考モデルとして挙げたが、rei-automatorへの適用は未検討

---

## 15. 関連情報

- **Rei言語リポジトリ:** fc0web/rei-lang（GitHub）
- **最新コミット:** f527f46（Phase 7a-7e + Phase 8a-8e完了、6,120行370テスト）
- **Reiベンチマーク:** 画像カーネル4×短縮、多次元データ集約3.7×、平均74%コード削減
- **仕様書ファイル:** rei-automator-spec.md（別途作成済み）
- **市場分析ドキュメント:** market-analysis-summary.docx（別途作成済み）

---

## 16. 次のチャットで推奨するアクション

**最優先:** Phase 1のMVP開発を開始する
- プロジェクト雛形作成（package.json、ディレクトリ構造）
- Electron基盤セットアップ
- 基本UIの実装
- Reiコード直接記述・実行の基盤

**または:** 以下の未決定事項を先に片付ける
- ツール名の決定
- 認識の類似度閾値の具体設計を仕様書に追加
- 教育事業との優先順位の最終確定
